// Resource Graph Explorer query to retrieve VNet and Subnet Information
Resources
| where type =~ 'microsoft.network/virtualnetworks'
| project subscriptionId, resourceGroup, vnetName = name, region = location, vnetAddressPrefixes = properties.addressSpace.addressPrefixes, subnets = properties.subnets
| mv-expand subnet = subnets
| extend subnetName = tostring(subnet.name), subnetAddressPrefixes = iff(isnotnull(subnet.properties.addressPrefixes), subnet.properties.addressPrefixes, pack_array(tostring(subnet.properties.addressPrefix)))
| extend aztenantId = "12345678-1234-1234-1234-123456789abc"  // <-- This line adds your static value
| project subscriptionId, aztenantId, resourceGroup, vnetName, vnetAddressPrefixes = tostring(vnetAddressPrefixes), region, subnetName, subnetAddressPrefixes = tostring(subnetAddressPrefixes)
| order by vnetName, subnetName
